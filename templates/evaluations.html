{% extends "base.html" %}
{% block content %}
<div class="card" style="padding:24px">
  <h2 class="h-title">Değerlendirme Kayıtları</h2>

  <form method="get" class="grid md:grid-cols-3 gap-4" style="margin-bottom:14px">
    <input name="q" placeholder="Ara: müdür, çalışan, bölge, eczane"
           value="{{ request.query_params.get('q','') }}">
    <input type="date" name="date_from" value="{{ request.query_params.get('date_from','') }}">
    <div style="display:flex; gap:8px">
      <input type="date" name="date_to" value="{{ request.query_params.get('date_to','') }}" style="flex:1">
      <button class="btn btn-brand">Filtrele</button>
    </div>
  </form>

  <!-- Masaüstü -->
  <div class="hidden md:block">
    <div style="overflow:auto">
      <table class="table">
        <thead>
          <tr>
            <th>Tarih</th>
            <th>Müdür</th>
            <th>Çalışan</th>
            <th>Bölge</th>
            <th>Eczane</th>
            <th>Skor</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
        {% for e in evaluations %}
          <tr>
            <td>{{ e.created_at[:16].replace('T',' ') }}</td>
            <td>{{ e.manager_name }}</td>
            <td>{{ e.rep_name }}</td>
            <td>{{ e.region_name or "-" }}</td>
            <td>{{ e.pharmacy_name or "-" }}</td>
            <td>{{ "%.0f"|format(e.percentage) }}%</td>
            <td><a class="btn btn-ghost" href="/evaluation/{{ e.id }}">Detay</a></td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- Mobil -->
  <div class="md:hidden space-y-3">
    {% for e in evaluations %}
    <a class="list-card" href="/evaluation/{{ e.id }}">
      <div class="muted">{{ e.created_at[:16].replace('T',' ') }}</div>
      <div style="font-weight:700">{{ e.rep_name }}</div>
      <div class="muted">{{ e.manager_name }} • {{ e.region_name or "-" }}</div>
      <div>Skor: <b>{{ "%.0f"|format(e.percentage) }}%</b></div>
    </a>
    {% endfor %}
  </div>
</div>
{% endblock %}
